<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <script>
        function createXHR(){
            if(typeof XMLHttpRequest != 'undefined'){
                //兼容IE7+，现代主流浏览器
                return new XMLHttpRequest();
            }else if(typeof ActiveXObject != 'undefined'){
                //兼容IE7-
                if(typeof arguments.callee.activeXString != "string"){
                    var version=["MSXML2.XMLHttp.6.0", "MSXML2.XMLHttp.3.0", "MSXML2.XMLHttp"];
                    for (var i = 0; i < version.length; i++) {
                        try {
                            new ActiveXObject(version[i]);
                            arguments.callee.activeXString = version[i];
                            break;
                        }catch(ex){
                            console.log(ex);
                        }
                    }
                }
                return new ActiveXObject(arguments.callee.activeXString);
            }else{
                throw new Error("没有XHR对象");
            }
        }
    </script>
</body>
</html>